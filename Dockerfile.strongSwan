FROM rockylinux:9.2

RUN dnf install -y epel-release && \
    dnf install -y strongswan strongswan-libipsec strongswan-sqlite iproute && \
    dnf clean all

RUN mkdir -p /ipsec.d/{cacerts,certs,private} && chmod 700 /ipsec.d

COPY dist/strongswan-setup /
RUN chmod +x configure.sh